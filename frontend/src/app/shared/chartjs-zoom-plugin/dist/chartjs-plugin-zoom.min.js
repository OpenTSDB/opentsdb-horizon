/**
 * This file is part of OpenTSDB.
 * Copyright (C) 2021  Yahoo.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
!function(){function e(o,t,n){function a(i,s){if(!t[i]){if(!o[i]){var c="function"==typeof require&&require;if(!s&&c)return c(i,!0);if(r)return r(i,!0);var m=new Error("Cannot find module '"+i+"'");throw m.code="MODULE_NOT_FOUND",m}var l=t[i]={exports:{}};o[i][0].call(l.exports,function(e){var t=o[i][1][e];return a(t||e)},l,l.exports,e,o,t,n)}return t[i].exports}for(var r="function"==typeof require&&require,i=0;i<n.length;i++)a(n[i]);return a}return e}()({1:[function(e,o,t){},{}],2:[function(e,o,t){var n=e("chart.js");n="function"==typeof n?n:window.Chart,n.Zoom=n.Zoom||{},n.Zoom.defaults={enabled:!1,mode:"x|y"};var a=e("./zoom.js")(n);o.exports=a,n.pluginService.register(a)},{"./zoom.js":3,"chart.js":1}],3:[function(e,o,t){"use strict";o.exports=function(e){function o(o){if(v=h.configMerge(e.Zoom.defaults,o.options.zoom),v.enabled){o.zoom={};var i=o.ctx.canvas;o.zoom.newLayer=document.createElement("canvas");var s=i.parentNode;o.zoom.newLayer.style.position="absolute",o.zoom.newLayer.style.left="0px",o.zoom.newLayer.style.top="0px",o.zoom.newLayer.style.zIndex=1,o.zoom.newLayer.style.visibility="hidden",s.appendChild(o.zoom.newLayer),o.zoom.newLayer.style.cursor="crosshair",i.style.cursor="crosshair",t(o),p.category=r,p.time=n,p.linear=a,p.logarithmic=a}}function t(e){var o=e.currentDevicePixelRatio||1;e.zoom.newLayer.width=e.width*o,e.zoom.newLayer.height=e.height*o,e.zoom.newLayer.getContext("2d").scale(o,o),e.zoom.newLayer.style.width=e.width+"px",e.zoom.newLayer.style.height=e.height+"px"}function n(e,o,t){var n=e.getValueForPixel(o),a=e.getValueForPixel(t);e.options.time.min=a.valueOf(),e.options.time.max=n.valueOf()}function a(e,o,t){var n=(e.max-e.min,e.getValueForPixel(o)),a=e.getValueForPixel(t);e.options.ticks.min=a,e.options.ticks.max=n}function r(e,o,t){var n=e.chart.data.labels,a=e.getValueForPixel(o),r=e.getValueForPixel(t);e.options.ticks.min=n[a],e.options.ticks.max=n[r]}function i(e){for(var o in e.scales){var t,n,a=e.scales[o],r=p[a.options.type];y.indexOf("x")!==-1&&a.isHorizontal()?(t=Math.min(l,u),n=Math.max(l,u),r&&r(a,t,n)):y.indexOf("y")===-1||a.isHorizontal()||(t=Math.min(f,d),n=Math.max(f,d),r&&r(a,t,n))}e.update(),c(e)}function s(e,o,t,n,a){var r=e.zoom.newLayer.getContext("2d");c(e),r.beginPath(),r.fillStyle="rgba(0,0,0,0.1)",r.lineWidth=1,r.setLineDash([]),r.fillRect(o,t,n,a),r.closePath(),r.restore()}function c(e){var o=e.zoom.newLayer.getContext("2d");o.clearRect(0,0,e.zoom.newLayer.width,e.zoom.newLayer.height)}function m(e,o,t){return e>=t.chartArea.left&&e<=t.chartArea.right&&o<=t.chartArea.bottom&&o>=t.chartArea.top}var l,f,u,d,v,h=e.helpers,x=!1,y="x",p={};return{id:"zoom",afterInit:function(e){if(o(e),v.enabled){h.each(e.scales,function(e){e.originalOptions=JSON.parse(JSON.stringify(e.options))}),e.resetZoom=function(){h.each(e.scales,function(e,o){var t=e.options.time,n=e.options.ticks;t&&(delete t.min,delete t.max),n&&(delete n.min,delete n.max),e.options=h.configMerge(e.options,e.originalOptions)}),h.each(e.data.datasets,function(e,o){e._meta=null}),e.update(0)},e.zoom._mouseDownHandler=function(o){"mousedown"==o.type&&m(o.offsetX,o.offsetY,e)&&(l=o.offsetX,f=o.offsetY,x=!0,h.addEvent(document,"mousemove",e.zoom._mouseMoveHandler),h.addEvent(document,"mouseup",e.zoom._mouseUpHandler))},e.zoom._doubleClickHandler=function(o){x=!1,e.zoom.newLayer.style.visibility="hidden",e.resetZoom()},e.zoom._mouseUpHandler=function(o){u=o.offsetX-e.ctx.canvas.offsetLeft,d=o.offsetY-e.ctx.canvas.offsetTop;var t=Math.abs(u-l);x&&t>0&&i(e),x=!1,e.zoom.newLayer.style.visibility="hidden",h.removeEvent(document,"mousemove",e.zoom._mouseMoveHandler),h.removeEvent(document,"mouseup",e.zoom._mouseUpHandler)},e.zoom._mouseMoveHandler=function(o){if(e.zoom.newLayer.style.visibility="visible",x){var t,n,a,r,i=o.offsetX-e.ctx.canvas.offsetLeft,c=o.offsetY-e.ctx.canvas.offsetTop,u=Math.abs(i-l),d=Math.abs(c-f);m(i,c,e)&&("xy"==v.mode?(y="xy",a=Math.min(l,i),r=Math.min(f,c),n=u,t=d):"x"==v.mode||"x|y"==v.mode&&u>d?(y="x",a=Math.min(l,i),r=e.chartArea.top,t=Math.abs(e.chartArea.bottom-e.chartArea.top),n=Math.abs(i-l)):("y"==v.mode||"x|y"==v.mode&&u<=d)&&(y="y",a=e.chartArea.left,r=Math.min(f,c),n=e.chartArea.right-e.chartArea.left,t=Math.abs(c-f)),s(e,a+e.ctx.canvas.offsetLeft,r+e.ctx.canvas.offsetTop,n,t,e.ctx))}},h.addEvent(e.ctx.canvas,"mousedown",e.zoom._mouseDownHandler),e.ctx.canvas.addEventListener("selectstart",function(e){return e.preventDefault(),!1},!1),h.addEvent(e.ctx.canvas,"dblclick",e.zoom._doubleClickHandler)}},resize:function(e){v.enabled&&t(e)},destroy:function(e){v.enabled&&(h.removeEvent(e.ctx.canvas,"mousedown",e.zoom._mouseDownHandler),h.removeEvent(e.ctx.canvas,"dblclick",e.zoom._doubleClickHandler),e.ctx.canvas.removeEventListener("selectstart",e.zoom._selectStartHandler),delete e.zoom)}}}},{}]},{},[2]);